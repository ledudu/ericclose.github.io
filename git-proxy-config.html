<!DOCTYPE html>
<html lang="zh-CN">
<head hexo-theme='https://github.com/volantis-x/hexo-theme-volantis/tree/4.1.1'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel='dns-prefetch' href='https://cdn.jsdelivr.net'>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
  <title>一文让你了解如何为 Git 设置代理 - Eric</title>
  
    <meta name="keywords" content="代理,Git,仓库,http,https,ssh">
  

  
    <meta name="description" content="如果你在克隆或从远程仓库获取数据时遇到很慢甚至超时的情况，那么此时你可能需要配置 Git 的代理。我这里就讲讲两种情况的代理方法：使用 HTTP 或 HTTPS 协议连接到 Git 仓库的代理方法和使用 SSH 协议连接到 Git 仓库的代理方法。">
  

  <!-- feed -->
  
    <link rel="alternate" href="/rss.xml" title="Eric" type="application/rss+xml">
  

  <!-- import meta -->
  
    
      <meta name="google-site-verification" content="KHZIpNl0zlKroVHmAmy-KTT561sBQ1fIp1kC7SKtMCc" />
    
  

  <!-- link -->
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14/css/all.min.css">

  
  

  

  

  

  

  <!-- import link -->
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/ericclose/cdn-assets@latest/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/ericclose/cdn-assets@latest/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/ericclose/cdn-assets@latest/favicon/favicon-16x16.png">
  <link rel="manifest" href="https://cdn.jsdelivr.net/gh/ericclose/cdn-assets@latest/favicon/site.webmanifest">
  

  
  
    
<link rel="stylesheet" href="/css/style.css">

  

  <script id="loadcss"></script>

</head>

<body>
  

<header id="l_header" class="l_header auto shadow blur show" style='opacity: 0' >
  <div class='container'>
  <div id='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone' id="pjax-header-nav-list">
        <li><a id="s-comment" class="fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a id="s-toc" class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
          
          
            Eric's Blog
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-home fa-fw'></i>首页
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-home fa-fw'></i>首页
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

  <div id="l_body">
    <div id="l_cover">
  
    
        <div id="full" class='cover-wrapper post search' style="display: none;">
          
            <div class='cover-bg' style='background-image:url(https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/001.jpg)'></div>
          
          <div class='cover-body'>
  <div class='top'>
    
    
      <p class="title">Eric's Blog</p>
    
    
      <p class="subtitle">Never really desperate, only the lost of the soul</p>
    
  </div>
  <div class='bottom'>
    
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <input type="text" class="input u-search-input" placeholder="" />
          <i class="icon fas fa-search fa-fw"></i>
        </form>
      </div>
    
    <div class='menu navigation'>
      <div class='list-h'>
        
          
            <a href="/"
              
              
              id="home">
              <i class='fas fa-home fa-fw'></i><p>首页</p>
            </a>
          
            <a href="/archives"
              
              
              id="archives">
              <i class='fas fa-archive fa-fw'></i><p>归档</p>
            </a>
          
            <a href="/friends"
              
                rel="nofollow"
              
              
                target="_self"
              
              id="friends">
              <i class='fas fa-link fa-fw'></i><p>友链</p>
            </a>
          
            <a href="/about"
              
                rel="nofollow"
              
              
              id="about">
              <i class='fas fa-info-circle fa-fw'></i><p>关于</p>
            </a>
          
        
      </div>
    </div>
  </div>
</div>

          <div id="scroll-down" style="display: none;"><i class="fa fa-chevron-down scroll-down-effects"></i></div>
        </div>
    
  
  </div>

    <div id='safearea'>
      <div class='body-wrapper' id="pjax-container">
        

<div class='l_main'>
  <article class="article post white-box reveal md shadow article-type-post" id="post" itemscope itemprop="blogPost">
  


  
  <div class="article-meta" id="top">
    
    
    
      <h1 class="title">
        一文让你了解如何为 Git 设置代理
      </h1>
      <div class='new-meta-box'>
        
          
            
<div class='new-meta-item author'>
  <a class='author' href="/" rel="nofollow">
    <img no-lazy src="https://cdn.jsdelivr.net/gh/ericclose/cdn-assets/img/avatar.jpeg">
    <p>Eric</p>
  </a>
</div>

          
        
          
            
  <div class='new-meta-item category'>
    <a class='notlink'>
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <a class="category-link" href="/categories/Proxy/">Proxy</a>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年3月31日</p>
  </a>
</div>

          
        
          
            

          
        
      </div>
    
  </div>


  
  <p>如果你在克隆或从远程仓库获取数据时遇到很慢甚至超时的情况，那么此时你可能需要配置 Git 的代理。我这里就讲讲两种情况的代理方法：<strong>使用 HTTP 或 HTTPS 协议连接到 Git 仓库的代理方法</strong>和<strong>使用 SSH 协议连接到 Git 仓库的代理方法</strong>。</p>
<a id="more"></a>

<hr>
<ul>
<li>如果远程仓库的格式像下面那样，这种就是<strong>使用 HTTP 或 HTTPS 协议连接到 Git 仓库</strong>的情况</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;github.com&#x2F;cms-sw&#x2F;cmssw.git</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;cms-sw&#x2F;cmssw.git</span><br></pre></td></tr></table></figure>

<ul>
<li>如果远程仓库的格式像下面那样，这种就是<strong>使用 SSH 协议连接到 Git 仓库</strong>的情况</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git@github.com:cms-sw&#x2F;cmssw.git</span><br><span class="line">ssh:&#x2F;&#x2F;git@github.com&#x2F;cms-sw&#x2F;cmssw.git</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="预先准备"><a href="#预先准备" class="headerlink" title="预先准备"></a>预先准备</h2><p>在<strong>开始操作之前</strong>，你<strong>需要明确</strong>这些内容：</p>
<ul>
<li>电脑已经安装了 Git（这不是废话吗，23333）。如果你是 Windows 用户，那么本文的命令你需要通过 Git Bash 来执行；如果你是 Linux 或 macOS 用户直接在终端运行即可。</li>
<li>知道如何用 vim 编辑文件，退出编辑的基本操作。</li>
</ul>
<hr>
<h2 id="使用-HTTP-或-HTTPS-协议连接到-Git-仓库的代理方法"><a href="#使用-HTTP-或-HTTPS-协议连接到-Git-仓库的代理方法" class="headerlink" title="使用 HTTP 或 HTTPS 协议连接到 Git 仓库的代理方法"></a>使用 HTTP 或 HTTPS 协议连接到 Git 仓库的代理方法</h2><h3 id="针对所有域名的-Git-仓库"><a href="#针对所有域名的-Git-仓库" class="headerlink" title="针对所有域名的 Git 仓库"></a>针对所有域名的 Git 仓库</h3><ul>
<li>这样做是对所有域名生效的的：</li>
</ul>
<blockquote>
<p>git config –global http.proxy <code>protocol</code>://127.0.0.1:<code>port</code></p>
</blockquote>
<p><strong>注意</strong>： <code>--glboal</code> 选项指的是修改 Git 的全局配置文件 <code>~/.gitconfig</code>，而非各个 Git 仓库里的配置文件 <code>.git/config</code>。<code>protocol</code> 指的是代理的协议，如 http，https，socks5 等。<code>port</code> 则为端口号。</p>
<h3 id="针对特定域名的-Git-仓库"><a href="#针对特定域名的-Git-仓库" class="headerlink" title="针对特定域名的 Git 仓库"></a>针对特定域名的 Git 仓库</h3><ul>
<li>或者针对特定域名生效：</li>
</ul>
<blockquote>
<p>git config –global http.<code>url</code>.proxy <code>protocol</code>://127.0.0.1:<code>port</code></p>
</blockquote>
<p><strong>注意</strong>： </p>
<ul>
<li>此处的 <code>url</code> 即为你需要走代理的仓库域名，<code>url</code> 以 <code>http://</code> 和 <code>https://</code> 打头的<strong>均用</strong>这个方法。</li>
<li>网上很多中文教程，可能会告诉你 <code>https://</code> 打头的 <code>url</code> 使用“git config –global <strong>https</strong>.<a target="_blank" rel="noopener" href="https://example.com.proxy/">https://example.com.proxy</a> <code>protocol</code>://127.0.0.1:<code>port</code>”，这种做法其实是错的！<strong>记住一点</strong>：Git 不认 <em>https.proxy</em> ，设置 <em>http.proxy</em> 就可以支持 https 了。</li>
<li>如果想了解 <code>url</code> 的更多模式，如子域名等的情况，可参照 <a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-config">Git 的官方文档</a> 。网页内容搜索 <code>http.&lt;url&gt;.*</code>，即可找到相关信息。</li>
</ul>
<hr>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><blockquote>
<p>针对 HTTP 或 HTTPS 协议连接到 Git 仓库的代理方法 Windows，Linux，macOS 用户的操作是一样的。</p>
</blockquote>
<p>也许你光看我上面的内容还看不明白，不妨我们来看下实例部分：</p>
<p>此处以 Clash for Windows 为例子。如图：</p>
<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/ericclose/images/git-proxy-config/1.png"/></div></div>

<p>Clash for Windows 既支持 <strong>HTTP / HTTPS</strong> 协议代理，也支持 <strong>SOCKS v5</strong> 协议代理。如果你使用其他的代理软件，你可以根据你使用的代理软件的<strong>代理协议</strong>和本地<strong>端口号</strong>参考本文修改即可。</p>
<hr>
<h4 id="针对所有域名的-Git-仓库-1"><a href="#针对所有域名的-Git-仓库-1" class="headerlink" title="针对所有域名的 Git 仓库"></a>针对所有域名的 Git 仓库</h4><p>根据你的代理软件支持的代理协议<strong>选取其中一种</strong>即可：</p>
<div class="tabs" id="1"><ul class="nav-tabs"><li class="tab active"><a class="#1-1">http 代理</a></li><li class="tab"><a class="#1-2">socks5 代理</a></li></ul><div class="tab-content"><div class="tab-pane active" id="1-1"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy http://127.0.0.1:7890</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：<em>7890</em> 为 Clash for Windows 的 http 代理端口。</p></div><div class="tab-pane" id="1-2"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy socks5://127.0.0.1:7891</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：<em>7891</em> 为 Clash for Windows 的 socks5 代理端口。</p></div></div></div>

<hr>
<h4 id="针对特定域名的-Git-仓库-1"><a href="#针对特定域名的-Git-仓库-1" class="headerlink" title="针对特定域名的 Git 仓库"></a>针对特定域名的 Git 仓库</h4><p>前面我们说的是，让所有域名下的仓库都走代理的情况，但是在现实情况下我们并不想这么做。那么现在我来介绍一下针对特定域名仓库走代理的做法，此处以 GitHub 为例:</p>
<p>当我们从 GitHub 仓库克隆源码时我们往往是这么做的的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/&lt;user&gt;/&lt;repository&gt;.git</span><br></pre></td></tr></table></figure>

<p>那么我前面所提到的 <code>url</code> 就是 <code>https://github.com</code></p>
<p>根据你的代理软件支持的代理协议<strong>选取其中一种</strong>即可：</p>
<div class="tabs" id="2"><ul class="nav-tabs"><li class="tab active"><a class="#2-1">http 代理</a></li><li class="tab"><a class="#2-2">socks5 代理</a></li></ul><div class="tab-content"><div class="tab-pane active" id="2-1"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.https://github.com.proxy http://127.0.0.1:7890</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="2-2"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.https://github.com.proxy socks5://127.0.0.1:7891</span><br></pre></td></tr></table></figure></div></div></div>

<hr>
<h2 id="使用-SSH-协议连接到-Git-仓库的代理方法"><a href="#使用-SSH-协议连接到-Git-仓库的代理方法" class="headerlink" title="使用 SSH 协议连接到 Git 仓库的代理方法"></a>使用 SSH 协议连接到 Git 仓库的代理方法</h2><p>在这种情况下，Git 依靠 ssh 处理连接； 为了通过代理进行连接，您必须配置 ssh 本身，在 <code>~/.ssh/config</code> 文件中设置 <strong>ProxyCommand</strong> 选项。Linux 和 macOS 是通过 <code>nc</code> 来执行 ProxyCommand 的，Windows 下则是通过 <code>connect</code>。</p>
<hr>
<h3 id="相关文档"><a href="#相关文档" class="headerlink" title="相关文档"></a>相关文档</h3><ul>
<li><a target="_blank" rel="noopener" href="https://man.openbsd.org/ssh_config">ssh_config(5)</a> ProxyCommand 的内容:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ProxyCommand</span><br><span class="line"></span><br><span class="line">Specifies the command to use to connect to the server. The command string extends to the end of the line, and is executed using the user&#39;s shell ‘exec’ directive to avoid a lingering shell process.</span><br><span class="line"></span><br><span class="line">Arguments to ProxyCommand accept the tokens described in the TOKENS section. The command can be basically anything, and should read from its standard input and write to its standard output. It should eventually connect an sshd(8) server running on some machine, or execute sshd -i somewhere. Host key management will be done using the Hostname of the host being connected (defaulting to the name typed by the user). Setting the command to none disables this option entirely. Note that CheckHostIP is not available for connects with a proxy command.</span><br><span class="line"></span><br><span class="line">This directive is useful in conjunction with nc(1) and its proxy support. For example, the following directive would connect via an HTTP proxy at 192.0.2.0:</span><br><span class="line"></span><br><span class="line">ProxyCommand &#x2F;usr&#x2F;bin&#x2F;nc -X connect -x 192.0.2.0:8080 %h %p</span><br></pre></td></tr></table></figure>

<ul>
<li><a target="_blank" rel="noopener" href="https://man.openbsd.org/nc">nc(1)</a> <code>-X</code> 和 <code>-x</code> 选项的的内容:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-X proxy_protocol</span><br><span class="line">Use proxy_protocol when talking to the proxy server. Supported protocols are 4 (SOCKS v.4), 5 (SOCKS v.5) and connect (HTTPS proxy). If the protocol is not specified, SOCKS version 5 is used.</span><br><span class="line"></span><br><span class="line">-x proxy_address[:port]</span><br><span class="line">Connect to destination using a proxy at proxy_address and port. If port is not specified, the well-known port for the proxy protocol is used (1080 for SOCKS, 3128 for HTTPS). An IPv6 address can be specified unambiguously by enclosing proxy_address in square brackets. A proxy cannot be used with any of the options -lsuU.</span><br></pre></td></tr></table></figure>

<ul>
<li><a target="_blank" rel="noopener" href="https://bitbucket.org/gotoh/connect/wiki/Home#!more-detail">connect</a> <code>-H</code> 和 <code>S</code> 选项的内容</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-H option specify hostname and port number of http proxy server to relay. If port is omitted, 80 is used. You can specify this value by environment variable HTTP_PROXY and give -h option to use it.</span><br><span class="line"></span><br><span class="line">-S option specify hostname and port number of SOCKS server to relay. Like -H option, port number can be omit and default is 1080. You can also specify this value pair by environment variable SOCKS5_SERVER and give -s option to use it.</span><br><span class="line"></span><br><span class="line">-4 and -5 is for specifying SOCKS protocol version. It is valid only using with -s or -S. Default is -5 (protocol version 5)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h3><p>接下来的操作，请按照你的<strong>系统</strong>，以及所需<strong>代理协议</strong>进行选择：</p>
<hr>
<h4 id="Linux-和-macOS-用户"><a href="#Linux-和-macOS-用户" class="headerlink" title="Linux 和 macOS 用户"></a>Linux 和 macOS 用户</h4><div class="tabs" id="3"><ul class="nav-tabs"><li class="tab active"><a class="#3-1">https 代理</a></li><li class="tab"><a class="#3-2">socks5 代理</a></li></ul><div class="tab-content"><div class="tab-pane active" id="3-1"><p>编辑 <code>~/.ssh/config</code> 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.ssh/config</span><br></pre></td></tr></table></figure>

<p>给文件加上如下内容:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">    User git</span><br><span class="line">    ProxyCommand nc -X connect -x 127.0.0.1:7890 %h %p</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>解释</strong>: </p>
<ul>
<li><code>Host</code> 后面 接的 <code>github.com</code> 是指定要走代理的仓库域名。</li>
<li>在 ProxyCommand 中，Linux 和 macOS 用户用的是 <code>nc</code>。</li>
<li><code>-X</code> 选项后面接的是 <code>connect</code> 的意思是 HTTPS 代理。</li>
<li><code>-x</code> 选项后面加上代理地址和端口号。</li>
<li>在调用 ProxyCommand 时，<code>％h</code> 和 <code>％p</code> 将会被自动替换为<strong>目标主机名</strong>和 <strong>SSH 命令指定的端口</strong>（<code>%h</code> 和 <code>%p</code> 不要修改，保留原样即可）。</li>
</ul>
</blockquote></div><div class="tab-pane" id="3-2"><p>编辑 <code>~/.ssh/config</code> 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.ssh/config</span><br></pre></td></tr></table></figure>

<p>给文件加上如下内容，2种任选一个:</p>
<blockquote>
<ul>
<li><code>Host</code> 后面 接的 <code>github.com</code> 是指定要走代理的仓库域名。</li>
<li>在 ProxyCommand 中，Linux 和 macOS 用户用的是 <code>nc</code> 。</li>
<li>在调用 ProxyCommand 时，<code>％h</code> 和 <code>％p</code> 将会被自动替换为<strong>目标主机名</strong>和 <strong>SSH 命令指定的端口</strong>（ <code>%h</code> 和 <code>%p</code> 不要修改，保留原样即可）。</li>
<li>如果 <code>-X</code> 选项后面接的是数字 <strong>5</strong>，那么指的就是 socks5 代理。</li>
<li>当然你直接不写上 <code>-X</code> 选项也是可以的，因为在没有指定协议的情况下，默认是使用socks5代理的。所以以下 <strong>2 种的写法效果一样</strong> ，都指的是走 socks5 代理：</li>
</ul>
</blockquote>
<p>①. 第一种</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">    User git</span><br><span class="line">    ProxyCommand nc -X 5 -x 127.0.0.1:7891 %h %p</span><br></pre></td></tr></table></figure>

<p>或</p>
<p>②. 第二种</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">    User git</span><br><span class="line">    ProxyCommand nc -x 127.0.0.1:7891 %h %p</span><br></pre></td></tr></table></figure></div></div></div>

<hr>
<h4 id="Windows-用户"><a href="#Windows-用户" class="headerlink" title="Windows 用户"></a>Windows 用户</h4><div class="tabs" id="4"><ul class="nav-tabs"><li class="tab active"><a class="#4-1">http 代理</a></li><li class="tab"><a class="#4-2">socks5 代理</a></li></ul><div class="tab-content"><div class="tab-pane active" id="4-1"><p>编辑 <code>~/.ssh/config</code> 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.ssh/config</span><br></pre></td></tr></table></figure>

<p>给文件加上以下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">    User git</span><br><span class="line">    ProxyCommand connect -H 127.0.0.1:7890 %h %p</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>解释</strong>: </p>
<ul>
<li><code>Host</code> 后面 接的 <code>github.com</code> 是指定要走代理的仓库域名。</li>
<li>在 ProxyCommand 中，Windows 用户用的是 <code>connect</code> 。</li>
<li><code>-H</code> 选项的意思是 HTTP 代理。</li>
<li>在调用 ProxyCommand 时，<code>％h</code> 和 <code>％p</code> 将会被自动替换为<strong>目标主机名</strong>和 <strong>SSH 命令指定的端口</strong>（ <code>%h</code> 和 <code>%p</code> 不要修改，保留原样即可）。</li>
</ul>
</blockquote></div><div class="tab-pane" id="4-2"><p>编辑 <code>~/.ssh/config</code> 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.ssh/config</span><br></pre></td></tr></table></figure>

<p>给文件加上如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">    User git</span><br><span class="line">    ProxyCommand connect -S 127.0.0.1:7891 %h %p</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>解释</strong>：</p>
<ul>
<li><code>Host</code> 后面 接的 <code>github.com</code> 是指定要走代理的仓库域名。</li>
<li>在 ProxyCommand 中，Windows 用户用的是 <code>connect</code>。</li>
<li>单独的 <code>-S</code> 选项指的就是 socks5 代理</li>
<li>在调用 ProxyCommand 时，<code>％h</code> 和 <code>％p</code> 将会被自动替换为<strong>目标主机名</strong>和 <strong>SSH 命令指定的端口</strong>（ <code>%h</code> 和 <code>%p</code> 不要修改，保留原样即可）。</li>
</ul>
</blockquote></div></div></div>

<hr>
<h2 id="如何取消-Git-和-ssh-的代理"><a href="#如何取消-Git-和-ssh-的代理" class="headerlink" title="如何取消 Git 和 ssh 的代理"></a>如何取消 Git 和 ssh 的代理</h2><p>这里就不多说了，说了那么多，我们无非就是修改了 2 个文件，即 <code>~/.gitconfig</code> 和 <code>~/.ssh/.config</code> ，<strong>删除</strong>或<strong>注释</strong>（在相应行的开头加上 <code>#</code>  即可）我们增加的相应内容即可完成取消代理。</p>
<hr>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ol>
<li><a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-config">Git - git-config Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/evantoli/f8c23a37eb3558ab8765">Configure Git to use a proxy</a></li>
<li><a target="_blank" rel="noopener" href="https://cms-sw.github.io/tutorial-proxy.html">Tutorial: how to use git through a proxy</a></li>
<li><a target="_blank" rel="noopener" href="https://man.openbsd.org/ssh_config">ssh_config(5) - OpenBSD manual pages</a></li>
<li><a target="_blank" rel="noopener" href="https://man.openbsd.org/nc">nc(1) - OpenBSD manual pages</a></li>
<li><a target="_blank" rel="noopener" href="https://bitbucket.org/gotoh/connect/wiki/Home#!more-detail">SSH Proxy Command – connect.c</a></li>
<li><a target="_blank" rel="noopener" href="https://superuser.com/a/454211">How can I use SSH with a SOCKS 5 proxy?</a></li>
<li><a target="_blank" rel="noopener" href="https://jeshs.github.io/2019/04/git%E5%9F%BA%E7%A1%80%E4%BB%A3%E7%90%86/">Git 基础——代理</a></li>
<li><a target="_blank" rel="noopener" href="https://www.perkin.org.uk/posts/ssh-via-http-proxy-in-osx.html">SSH via HTTP proxy in OSX</a></li>
</ol>

  
  
    
    <div class='footer'>
      
      
      
        <div class='copyright'>
          <blockquote>
            
              
                <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

              
            
              
                <p>本文永久链接是：<a href=https://ericclose.github.io/git-proxy-config.html>https://ericclose.github.io/git-proxy-config.html</a></p>
              
            
          </blockquote>
        </div>
      
      
    </div>
  
  
    


  <div class='article-meta' id="bottom">
    <div class='new-meta-box'>
      
        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E4%BB%A3%E7%90%86/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>代理</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Git/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>Git</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E4%BB%93%E5%BA%93/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>仓库</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/http/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>http</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/https/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>https</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/ssh/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>ssh</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ericclose.github.io/git-proxy-config.html&title=一文让你了解如何为 Git 设置代理 - Eric&summary=如果你在克隆或从远程仓库获取数据时遇到很慢甚至超时的情况，那么此时你可能需要配置 Git 的代理。我这里就讲讲两种情况的代理方法：使用 HTTP 或 HTTPS 协议连接到 Git 仓库的代理方法和使用 SSH 协议连接到 Git 仓库的代理方法。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://ericclose.github.io/git-proxy-config.html&title=一文让你了解如何为 Git 设置代理 - Eric&summary=如果你在克隆或从远程仓库获取数据时遇到很慢甚至超时的情况，那么此时你可能需要配置 Git 的代理。我这里就讲讲两种情况的代理方法：使用 HTTP 或 HTTPS 协议连接到 Git 仓库的代理方法和使用 SSH 协议连接到 Git 仓库的代理方法。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://service.weibo.com/share/share.php?url=https://ericclose.github.io/git-proxy-config.html&title=一文让你了解如何为 Git 设置代理 - Eric&summary=如果你在克隆或从远程仓库获取数据时遇到很慢甚至超时的情况，那么此时你可能需要配置 Git 的代理。我这里就讲讲两种情况的代理方法：使用 HTTP 或 HTTPS 协议连接到 Git 仓库的代理方法和使用 SSH 协议连接到 Git 仓库的代理方法。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/weibo.png">
          
        </a>
      
    
      
    
      
        <a class="-mob-share-telegram" title="" rel="external nofollow noopener noreferrer noopener"
          
            target="_blank" href="https://t.me/share/url?url=https://ericclose.github.io/git-proxy-config.html&text=一文让你了解如何为 Git 设置代理 - Eric"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/telegram.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </div>


  
  

  
    <div class="prev-next">
      
        <a class='prev' href='/libinput-gestures-on-Arch-Linux-with-KDE.html'>
          <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>Arch Linux with KDE 配置触控板手势</p>
          <p class='content'>本文教你如何配置触控板的手势，以 Arch Linux 为例，桌面环境为 KDE。

libinput-gestures: 使用libinput在触摸板上执行动作手势


将当前用户加入到inp...</p>
        </a>
      
      
        <a class='next' href='/active-Windows-10-with-digital-license.html'>
          <p class='title'>如何通过 HWIDGEN 以数字许可的方式激活 Windows 10<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
          <p class='content'>HWIDGEN 是一款由国外 Nsane 论坛会员 s1ave77 制作的 Windows 10 数字权利激活工具。这款 Windows 10 数字权利获取工具，可以自动获取 Windows 1...</p>
        </a>
      
    </div>
  
</article>


  

  <article class="post white-box reveal shadow" id="comments">
    <p ct><i class='fas fa-comments'></i> 评论</p>
    
    <div id="gitalk-container"></div>

  </article>






</div>
<aside class='l_side'>
  
  
    
    



  <section class="widget toc-wrapper shadow desktop mobile" id="toc-div" >
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%84%E5%85%88%E5%87%86%E5%A4%87"><span class="toc-text">预先准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-HTTP-%E6%88%96-HTTPS-%E5%8D%8F%E8%AE%AE%E8%BF%9E%E6%8E%A5%E5%88%B0-Git-%E4%BB%93%E5%BA%93%E7%9A%84%E4%BB%A3%E7%90%86%E6%96%B9%E6%B3%95"><span class="toc-text">使用 HTTP 或 HTTPS 协议连接到 Git 仓库的代理方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%92%88%E5%AF%B9%E6%89%80%E6%9C%89%E5%9F%9F%E5%90%8D%E7%9A%84-Git-%E4%BB%93%E5%BA%93"><span class="toc-text">针对所有域名的 Git 仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%92%88%E5%AF%B9%E7%89%B9%E5%AE%9A%E5%9F%9F%E5%90%8D%E7%9A%84-Git-%E4%BB%93%E5%BA%93"><span class="toc-text">针对特定域名的 Git 仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-text">实例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%92%88%E5%AF%B9%E6%89%80%E6%9C%89%E5%9F%9F%E5%90%8D%E7%9A%84-Git-%E4%BB%93%E5%BA%93-1"><span class="toc-text">针对所有域名的 Git 仓库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%92%88%E5%AF%B9%E7%89%B9%E5%AE%9A%E5%9F%9F%E5%90%8D%E7%9A%84-Git-%E4%BB%93%E5%BA%93-1"><span class="toc-text">针对特定域名的 Git 仓库</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-SSH-%E5%8D%8F%E8%AE%AE%E8%BF%9E%E6%8E%A5%E5%88%B0-Git-%E4%BB%93%E5%BA%93%E7%9A%84%E4%BB%A3%E7%90%86%E6%96%B9%E6%B3%95"><span class="toc-text">使用 SSH 协议连接到 Git 仓库的代理方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%96%87%E6%A1%A3"><span class="toc-text">相关文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-1"><span class="toc-text">实例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Linux-%E5%92%8C-macOS-%E7%94%A8%E6%88%B7"><span class="toc-text">Linux 和 macOS 用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Windows-%E7%94%A8%E6%88%B7"><span class="toc-text">Windows 用户</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%8F%96%E6%B6%88-Git-%E5%92%8C-ssh-%E7%9A%84%E4%BB%A3%E7%90%86"><span class="toc-text">如何取消 Git 和 ssh 的代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="toc-text">参考链接</span></a></li></ol>
    </div>
  </section>


  


</aside>



        
        
          <!--此文件用来存放一些不方便取值的变量-->
<!--思路大概是将值藏到重加载的区域内-->

<script>
  window.pdata={}
  pdata.ispage=true;
  pdata.postTitle="一文让你了解如何为 Git 设置代理";
  pdata.commentPath="";
  pdata.commentPlaceholder="";

  var l_header=document.getElementById("l_header");
  
  l_header.classList.add("show");
  
</script>

        
      </div>
      
  
  <footer class="footer clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/rss.xml"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
                
              </a>
            
          
            
              <a href="mailto:ZetaGo@protonmail.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
                
              </a>
            
          
            
              <a href="https://github.com/ericclose"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
                
              </a>
            
          
            
              <a href="https://t.me/Soul_Land"
                class="social fab fa-telegram flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
                
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        
      
    
      
        本站使用
        <a href="https://github.com/volantis-x/hexo-theme-volantis/tree/4.1.1" target="_blank" class="codename">Volantis</a>
        作为主题
      
    
      
        <div class='copyright'>
        <p><a href="/">Copyright © 2018-2020 Eric</a></p>

        </div>
      
    
  </footer>


      <a id="s-top" class="fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
    </div>
  </div>
  <div>
    <script>
window.volantis={};
/********************脚本懒加载函数********************************/
function loadScript(src, cb) {
var HEAD = document.getElementsByTagName('head')[0] || document.documentElement;
var script = document.createElement('script');
script.setAttribute('type','text/javascript');
if (cb) script.onload = cb;
script.setAttribute('src', src);
HEAD.appendChild(script);
}
//https://github.com/filamentgroup/loadCSS
var loadCSS = function( href, before, media, attributes ){
	var doc = window.document;
	var ss = doc.createElement( "link" );
	var ref;
	if( before ){
		ref = before;
	}
	else {
		var refs = ( doc.body || doc.getElementsByTagName( "head" )[ 0 ] ).childNodes;
		ref = refs[ refs.length - 1];
	}
	var sheets = doc.styleSheets;
	if( attributes ){
		for( var attributeName in attributes ){
			if( attributes.hasOwnProperty( attributeName ) ){
				ss.setAttribute( attributeName, attributes[attributeName] );
			}
		}
	}
	ss.rel = "stylesheet";
	ss.href = href;
	ss.media = "only x";
	function ready( cb ){
		if( doc.body ){
			return cb();
		}
		setTimeout(function(){
			ready( cb );
		});
	}
	ready( function(){
		ref.parentNode.insertBefore( ss, ( before ? ref : ref.nextSibling ) );
	});
	var onloadcssdefined = function( cb ){
		var resolvedHref = ss.href;
		var i = sheets.length;
		while( i-- ){
			if( sheets[ i ].href === resolvedHref ){
				return cb();
			}
		}
		setTimeout(function() {
			onloadcssdefined( cb );
		});
	};
	function loadCB(){
		if( ss.addEventListener ){
			ss.removeEventListener( "load", loadCB );
		}
		ss.media = media || "all";
	}
	if( ss.addEventListener ){
		ss.addEventListener( "load", loadCB);
	}
	ss.onloadcssdefined = onloadcssdefined;
	onloadcssdefined( loadCB );
	return ss;
};
</script>
<!-- required -->

<script src="https://cdn.jsdelivr.net/npm/jquery@3.5/dist/jquery.min.js"></script>

<script>
  function pjax_fancybox() {
    $(".md .gallery").find("img").each(function () { //渲染 fancybox
      var element = document.createElement("a"); // a 标签
      $(element).attr("class", "fancybox");
      $(element).attr("pjax-fancybox", "");  // 过滤 pjax
      $(element).attr("href", $(this).attr("src"));
      if ($(this).attr("data-original")) {
        $(element).attr("href", $(this).attr("data-original"));
      }
      $(element).attr("data-fancybox", "images");
      var caption = "";   // 描述信息
      if ($(this).attr('alt')) {  // 判断当前页面是否存在描述信息
        $(element).attr('data-caption', $(this).attr('alt'));
        caption = $(this).attr('alt');
      }
      var div = document.createElement("div");
      $(div).addClass("fancybox");
      $(this).wrap(div); // 最外层套 div ，其实主要作用还是 class 样式
      var span = document.createElement("span");
      $(span).addClass("image-caption");
      $(span).text(caption); // 加描述
      $(this).after(span);  // 再套一层描述
      $(this).wrap(element);  // 最后套 a 标签
    })
    $(".md .gallery").find("img").fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
      closeClick: true,
      helpers: {
        overlay: {closeClick: true}
      },
      buttons: [
        "zoom",
        "close"
      ]
    });
  };
  function SCload_fancybox() {
    if ($(".md .gallery").find("img").length == 0) return;
    loadCSS("https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css", document.getElementById("loadcss"));
    setTimeout(function() {
      loadScript('https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js', pjax_fancybox)
    }, 1);
  };
  $(function () {
    SCload_fancybox();
  });
</script>


<!-- internal -->









  
  
    <script>
      window.FPConfig = {
        delay: 0,
        ignoreKeywords: [],
        maxRPS: 5,
        hoverDelay: 25
      };
    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"></script>
  




  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
    var clipboard = new ClipboardJS('.btn-copy', {
        target: function (trigger) {
            return trigger.nextElementSibling
        }
    });
    function wait(callback, seconds) {
        var timelag = null;
        timelag = window.setTimeout(callback, seconds)
    }
    function pjax_initCopyCode() {
		if($(".highlight .code pre").length+$(".article pre code").length==0)return;
        var copyHtml = '';
        copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
        copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
        copyHtml += '</button>';
        $(".highlight .code pre").before(copyHtml);
        $(".article pre code").before(copyHtml);
        clipboard.off('success').on('success', function (e) {
            let $btn = $(e.trigger);
            $btn.addClass('copied');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-check-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPIED';
            wait(function () {
                $icon.removeClass('fa-check-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        });
        clipboard.off('error').on('error', function (e) {
            e.clearSelection();
            let $btn = $(e.trigger);
            $btn.addClass('copy-failed');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-times-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPY FAILED';
            wait(function () {
                $icon.removeClass('fa-times-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        })
    }
    $(function () {
        pjax_initCopyCode()
    });
</script>








  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script type="text/javascript">
  function pjax_gitalk() {
    if(!document.querySelectorAll("#gitalk-container")[0])return;

    let path = pdata.commentPath;
    if (path.length == 0) {
      let defaultPath = '';
      path = defaultPath || decodeURI(window.location.pathname);
    }

    if (document.getElementById('gitalk-container') != null) {
      var gitalk = new Gitalk({
        clientID: "41b3f5366c50441cfe71",
        clientSecret: "884e7079c59b07a70d9236c334507ce89f9cd469",
        repo: "comments",
        owner: "ericclose",
        admin: "ericclose",
        id: path,
        distractionFreeMode: false  // Facebook-like distraction free mode
      });
      gitalk.render('gitalk-container');
    }
  }

  $(function () {
    pjax_gitalk();
  });
</script>





  
<script src="/js/app.js"></script>




  
    
<script src="/js/search.js"></script>

  


<!-- optional -->

  <script>
const SearchServiceimagePath="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@master/img/";
const ROOT =  ("/" || "/").endsWith('/') ? ("/" || "/") : ("//" || "/" );
(function ($) {
  
    customSearch = new HexoSearch({
      imagePath: SearchServiceimagePath
    });
  
})(jQuery);

</script>













  <script>
const rootElement = document.documentElement;
const darkModeStorageKey = "user-color-scheme";
const rootElementDarkModeAttributeName = "data-user-color-scheme";

const setLS = (k, v) => {
  try {
    localStorage.setItem(k, v);
  } catch (e) {
    console.log(e.message);
  }
};

const removeLS = (k) => {
  try {
    localStorage.removeItem(k);
  } catch (e) {
    console.log(e.message);
  }
};

const getLS = (k) => {
  try {
    return localStorage.getItem(k);
  } catch (e) {
    console.log(e.message);
    return null;
  }
};

const getModeFromCSSMediaQuery = () => {
  return window.matchMedia("(prefers-color-scheme: dark)").matches
    ? "dark"
    : "light";
};

const resetRootDarkModeAttributeAndLS = () => {
  rootElement.removeAttribute(rootElementDarkModeAttributeName);
  removeLS(darkModeStorageKey);
};

const validColorModeKeys = {
  dark: true,
  light: true,
};

const applyCustomDarkModeSettings = (mode) => {
  const currentSetting = mode || getLS(darkModeStorageKey);

  if (currentSetting === getModeFromCSSMediaQuery()) {
    resetRootDarkModeAttributeAndLS();
  } else if (validColorModeKeys[currentSetting]) {
    rootElement.setAttribute(rootElementDarkModeAttributeName, currentSetting);
  } else {
    resetRootDarkModeAttributeAndLS();
  }
};

const invertDarkModeObj = {
  dark: "light",
  light: "dark",
};

/**
 * get target mode
 */
const toggleCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);

  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  setLS(darkModeStorageKey, currentSetting);
  return currentSetting;
};

/**
 * bind click event for toggle button
 */
function bindToggleButton() {
	var btn=$("#wrapper .toggle-mode-btn");
    btn.on('click',(e) => {
      const mode = toggleCustomDarkMode();
      applyCustomDarkModeSettings(mode);
    });
}
$("#wrapper .darkbtn").parents(".header").addClass("toggle-mode-btn")
applyCustomDarkModeSettings();
document.addEventListener("DOMContentLoaded", bindToggleButton);
document.addEventListener("pjax:success", bindToggleButton);
var now = new Date();
var hour = now.getHours();
if (hour < 7 && hour >= 19) {
	var mode = toggleCustomDarkMode();
	if (mode === "dark") {
	  applyCustomDarkModeSettings(mode);
	}
}
</script>




<!-- Global site tag (gtag.js) - Google Analytics -->
<script>
setTimeout(function() {
  window.ga_tid = 'UA-127459865-1';
   (function() {
	 var dga = document.createElement("script");
	 dga.src = "https://rmt.dogedoge.com/fetch/public/ga.js";
	  var s = document.getElementsByTagName("script")[0];
	  s.parentNode.insertBefore(dga, s);
  })();
}, 5000);
</script>



<script>
function listennSidebarTOC() {
  const navItems = document.querySelectorAll(".toc li");
  if (!navItems.length) return;
  const sections = [...navItems].map((element) => {
    const link = element.querySelector(".toc-link");
    const target = document.getElementById(
      decodeURI(link.getAttribute("href")).replace("#", "")
    );
    link.addEventListener("click", (event) => {
      event.preventDefault();
      window.scrollTo({
		top: target.offsetTop + 100,
		
		behavior: "smooth"
		
	  });
    });
    return target;
  });

  function activateNavByIndex(target) {
    if (target.classList.contains("active-current")) return;

    document.querySelectorAll(".toc .active").forEach((element) => {
      element.classList.remove("active", "active-current");
    });
    target.classList.add("active", "active-current");
    let parent = target.parentNode;
    while (!parent.matches(".toc")) {
      if (parent.matches("li")) parent.classList.add("active");
      parent = parent.parentNode;
    }
  }

  function findIndex(entries) {
    let index = 0;
    let entry = entries[index];
    if (entry.boundingClientRect.top > 0) {
      index = sections.indexOf(entry.target);
      return index === 0 ? 0 : index - 1;
    }
    for (; index < entries.length; index++) {
      if (entries[index].boundingClientRect.top <= 0) {
        entry = entries[index];
      } else {
        return sections.indexOf(entry.target);
      }
    }
    return sections.indexOf(entry.target);
  }

  function createIntersectionObserver(marginTop) {
    marginTop = Math.floor(marginTop + 10000);
    let intersectionObserver = new IntersectionObserver(
      (entries, observe) => {
        let scrollHeight = document.documentElement.scrollHeight + 100;
        if (scrollHeight > marginTop) {
          observe.disconnect();
          createIntersectionObserver(scrollHeight);
          return;
        }
        let index = findIndex(entries);
        activateNavByIndex(navItems[index]);
      },
      {
        rootMargin: marginTop + "px 0px -100% 0px",
        threshold: 0,
      }
    );
    sections.forEach((element) => {
      element && intersectionObserver.observe(element);
    });
  }
  createIntersectionObserver(document.documentElement.scrollHeight);
}

document.addEventListener("DOMContentLoaded", listennSidebarTOC);
document.addEventListener("pjax:success", listennSidebarTOC);
</script>

<!-- more -->

  
  <script src="https://cdn.jsdelivr.net/gh/ericclose/cdn-assets/js/custom.js"></script>






    
      


<script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script>

<!-- 样式位于：source/css/_third-party/pjaxanimate.styl -->

<div class="pjax-animate">
  
    <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>
    <div id="loading-bar-wrapper"><script>NProgress.configure({parent:"#loading-bar-wrapper",trickleSpeed: 100})</script></div>
    <script>
      window.ShowLoading = function() {
        NProgress.start();
      };
      window.HideLoading = function() {
        NProgress.done();
      }
    </script>
  
</div>

<script>
    var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox])',
        selectors: [
          "title",
          "#l_cover",
          "#pjax-container",
          "#pjax-header-nav-list"
        ],
        cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
        timeout: 5000
      });
    });

    document.addEventListener('pjax:send', function (e) {
      //window.stop(); // 相当于点击了浏览器的停止按钮

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      window.subData = null; // 移除标题（用于一二级导航栏切换处）
      if (typeof $.fancybox != "undefined") {
        $.fancybox.close();    // 关闭弹窗
      }
      volantis.$switcher.removeClass('active'); // 关闭移动端激活的搜索框
      volantis.$header.removeClass('z_search-open'); // 关闭移动端激活的搜索框
      volantis.$wrapper.removeClass('sub'); // 跳转页面时关闭二级导航

      // 解绑事件 避免重复监听
      volantis.$topBtn.unbind('click');
      $('.menu a').unbind('click');
      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');
      window.ShowLoading();
    });

    document.addEventListener('pjax:complete', function () {
      // 关于百度统计对 SPA 页面的处理：
      // 方案一：百度统计>管理>单页应用设置中，打开开启按钮即可对SPA进行统计。 https://tongji.baidu.com/web/help/article?id=324
      // 方案二：取消注释下列代码。 https://tongji.baidu.com/web/help/article?id=235
      // 

      // 关于谷歌统计对 SPA 页面的处理：
      // 当应用以动态方式加载内容并更新地址栏中的网址时，也应该更新通过 gtag.js 存储的网页网址。
      // https://developers.google.cn/analytics/devguides/collection/gtagjs/single-page-applications?hl=zh-cn
      
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('config', 'UA-127459865-1', {'page_path': document.location.pathname});
      

      $('.nav-main').find('.list-v').not('.menu-phone').removeAttr("style",""); // 移除小尾巴的移除
      $('.menu-phone.list-v').removeAttr("style",""); // 移除小尾巴的移除
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
      try{
          if (typeof $.fancybox == "undefined") {
            SCload_fancybox();
          } else {
            pjax_fancybox();
          }
        
        
        
        
        
          pjax_initCopyCode();
        
        
        
        
          pjax_gitalk();
        
        
      } catch (e) {
        console.log(e);
      }
      window.HideLoading();
    });

    document.addEventListener('pjax:error', function (e) {
      window.HideLoading();
      window.location.href = e.triggerElement.href;
    });
</script>

    
  </div>
</body>
</html>
